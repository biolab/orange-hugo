<html>    
    <head>
    <title>Orange Data Mining - Aggregate, Group By and Pivot with... Pivot Table!</title>

    
    
    <meta property="og:title" content="Aggregate, Group By and Pivot with... Pivot Table!">
    
    
    <meta property="og:description" content="Orange&#39;s brand new Pivot Table widget with many aggregation and grouping functionalities.">
    
    
    <meta property="og:image" content="/blog_img/2019/2019-08-27_pivot-preview.png">
    

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Orange Data Mining Toolbox">
    <meta name="author" content="Bioinformatics Laboratory, University of Ljubljana">
    <meta name="google-site-verification" content="DS7GH5M7ABi78pIC2rMcTBFx-UeBFObXOeLvR7Ow3EQ" />
    <link rel="shortcut icon" href="/images/favicon.ico">
    
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Covered+By+Your+Grace' rel='stylesheet' type='text/css'>
    
    <link rel="stylesheet" href="/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/plugins/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="/plugins/lightgallery/css/lightgallery.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/build/css/styles.min.css">
    <script id="dsq-count-scr" src="//orange-4.disqus.com/count.js" async></script>

     <script src="https://www.recaptcha.net/recaptcha/api.js" async defer></script>
    <noscript>
        <style>
            .jsonly { display: none !important; }
        </style>
    </noscript>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-528382-1', 'auto');
      ga('require', 'linkid');
      ga('send', 'pageview');


    </script>

    
 

    <script type="text/javascript" src="/plugins/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/plugins/jquery.form.js"></script> 
    <script type="text/javascript" src="/plugins/bootstrap/js/bootstrap.min.js"></script>
    
    <script type="text/javascript" src="/plugins/lightgallery/js/lightgallery.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-thumbnail.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-video.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-zoom.js"></script>
    <script type="text/javascript" src="/js/custom.js"></script>

    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5X4T27');</script>
    

    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5X4T27"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    

    
    <script type="text/javascript">
      $( document ).ready( function () {

        $('a').off("click").click( function ( event ) {
           ga('send', 'event', "a", event.type, $(this).attr("id"), 1 );
        });

        $('[class *= trackClicks_]').off("click").click( function ( event ) {
           var classList = $(this).attr('class').split(/\s+/);
           var trackname = "";
           $.each(classList, function(index, item) {
             if (item.indexOf('trackClicks_') === 0) {
                trackname = item;
             }
           });
           ga('send', 'event', "a", event.type, trackname, 1 );
        });
      });
    </script>

</head>
    <body>

     <header id="top" class="header navbar-fixed-top">
        <div class="container" >
            <h1 class="logo pull-left" >
                <a id="header-orangelogo" href="/">
                    <img id="logo-image" class="logo-image" src="/images/orange_logo_hq.png" alt="Logo">
                </a>
            </h1>
            <nav id="main-nav" class="main-nav navbar-right" role="navigation">
                <div class="navbar-header">
                    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
               <div class="navbar-collapse collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/screenshots/">Screenshots</a></li>
                            
                        
                    
                    
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/workflows/">Workflows</a></li>
                            
                        
                    
                    
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/download/">Download</a></li>
                            
                        
                    
                    
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/blog/">Blog</a></li>
                            
                        
                    
                    
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/docs/">Docs</a></li>
                            
                        
                    
                    
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/training/">Workshops</a></li>
                            
                        
                    
                    
                        
                            
                        <li class="">
                            <a class="btn btn-warning big-button-base donate" id="header-donate-link" role="button" target="_blank" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J">Donate</a>
                        </li>
                            
                        
                    
                    
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <div id="main">
        <div class="container-fluid clear-top">
            
<div id="overflow-container" class="overflow-container">
  <div id="loop-container" class="offset-header container">
    
      <div
        class="blog-font-size post type-post status-publish format-standard category-standard category-travel full-without-featured odd excerpt-1 no-image">
        
        <div class="entry-meta remove-padding-l-r">
          <span>Categories: </span>
          
        </div>
        <div class='entry-header remove-padding-l-r'>
          <h1 class='entry-title'> Aggregate, Group By and Pivot with... Pivot Table!</h1>
          <span class="author-blog">
            
            By: Ajda Pretnar,
            
            Aug 27, 2019
          </span>
        </div>
        <div class="entry-container remove-padding-l-r">
          <div class="entry-content md">
            <article>
              <div id="blog_images_">


              <p>Orange recently welcomed its new Pivot Table widget, which offers functionalities for data aggregation, grouping and, well, pivot tables. The widget is a one-stop-shop for pandas&rsquo; aggregate, groupby and pivot_table functions.</p>
<a href="/blog_img/2019/2019-08-27_workflow.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_workflow.png" />
 </a>
<p>\</p>
<p>Let us see how to achieve these tasks in Orange. For all of the below examples we will be using the <em>heart_disease.tab</em> data.</p>
<h2 id="pandasdataframeagg">pandas.DataFrame.agg</h2>
<p>The first task is computing a simple mean for the column <em>age</em>.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.aggregate.html">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt;df['age'].agg('mean')
54.43894389438944
</code></pre><p>\</p>
<p>In Orange:</p>
<p>In <strong>Pivot Table</strong> we set <em>Values</em> to <em>age</em> and set aggregations to <em>mean</em>. There is no way to turn off splitting by rows in Pivot Table, but the values in Total report the mean value for the chosen attribute.</p>
<a href="/blog_img/2019/2019-08-27_pivot-aggregate.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_pivot-aggregate.png" />
 </a>
<p>\</p>
<p>An even better way to observe simple statistics is in <strong>Feature Statistics</strong> widget. The widget also reports on the mean value of each attribute with handy distributions plots included.</p>
<a href="/blog_img/2019/2019-08-27_feature-statistics.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_feature-statistics.png" />
 </a>
<p>\</p>
<p>Yet another way to observe a mean value is in a <strong>Box Plot</strong>.</p>
<a href="/blog_img/2019/2019-08-27_box-plot.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_box-plot.png" />
 </a>
<p><br>
\</p>
<h2 id="pandasdataframegroupby">pandas.DataFrame.groupby</h2>
<p>The second task is grouping the data by a discrete column. Say we want to group by gender and report the mean value for each column.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt; df.groupby(['gender']).mean()
              age    rest SBP   ...  ST by exer.  major ves. col.  diameter narrowing
gender
female  55.721649  133.340206   ...   0.867010    0.546392          0.257732
male    53.834951  130.912621   ...   1.120874    0.732673          0.553398

[2 rows x 9 columns]
</code></pre><p>In Orange:</p>
<p>In <strong>Pivot Table</strong> set <em>Rows</em> to <em>gender</em> and aggregation method to <em>mean</em>. The <em>Values</em> option in this example has no effect. Now, connect <strong>Data Table</strong> to Pivot Table. Finally, reset the connections. Pivot Table outputs three types of data - Pivot Table, Filtered Data, and Grouped Data. The output we are looking for here is <em>Grouped Data</em>.</p>
<a href="/blog_img/2019/2019-08-27_edit-links.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_edit-links.png" />
 </a>
<p>\</p>
<a href="/blog_img/2019/2019-08-27_pivot-groupby.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_pivot-groupby.png" />
 </a>
<p>\</p>
<p>This is our data table. Exactly what we were looking for.</p>
<a href="/blog_img/2019/2019-08-27_groupby-data-table.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_groupby-data-table.png" />
 </a>
<p><br>
\</p>
<h2 id="pandasdataframepivot_table">pandas.DataFrame.pivot_table</h2>
<p>The third, final task is constructing a pivot table where rows are values of <em>diameter narrowing</em>, columns are values of <em>gender</em> and the values in cells is the mean of <em>age</em> for each subgroup. In other words, we want to see the average age of females with diameter narrowing, males with diameter narrowing, females without diameter narrowing and males without diameter narrowing.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html#pandas.DataFrame.pivot_table">In pandas</a>:</p>
<pre><code>&gt;&gt;&gt; pd.pivot_table(df, values='age', index=['diameter narrowing'], columns=['gender'], aggfunc=np.mean)
gender                 female       male
diameter narrowing
0                   54.555556  51.043478
1                   59.080000  56.087719
</code></pre><p>In Orange:</p>
<p>In <strong>Pivot Table</strong> set <em>Rows</em> to <em>diameter narrowing</em>, <em>Columns</em> to <em>gender</em>, <em>Values</em> to <em>age</em> and aggregation method to <em>mean</em>. The widget already offers a view of the final data table, but we can also output it and use it in other Orange widgets.</p>
<a href="/blog_img/2019/2019-08-27_pivot-table.png" class="blog-image_"> 
      <img src="/blog_img/2019/2019-08-27_pivot-table.png" />
 </a>
<p><br>
\</p>
<p><strong>Pivot Table</strong> widget really versatile - like a Swiss knife for data transformation.</p>

            </div>
            </article>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://orange-4.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#blog_images_').lightGallery({
        thumbnail: false,
        selector: 'a:has(img)',
        width: '60%',
        mode: 'lg-fade',
        counter: false,
        download: false,
        enableSwipe: false,
        enableDrag: false,
        speed: 1,
        useLeft: true,
        hideBarsDelay: 1000
    });
    });
</script>

        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <div class="row">

                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Orange</div></b></li>
                                <li><a class="sitemap-sub" href="/faq/">FAQ</a></li>
                                <li><a class="sitemap-sub" href="/license/">License</a></li>
                                <li><a class="sitemap-sub" href="/privacy/">Privacy</a></li>
                                <li><a class="sitemap-sub" href="/citation/">Citation</a></li>
                                <li><a class="sitemap-sub" href="/contact/">Contact</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Download</div></li>
                                <li><a class="sitemap-sub" href="/download/#windows">Windows</a></li>
                                <li><a class="sitemap-sub" href="/download/#macos">Mac OS</a></li>
                                
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">

                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Community</div></b></li>
                                <li><a class="sitemap-sub" href="https://www.facebook.com/orangedm" target="_blank">Facebook</a></li>
                                <li><a class="sitemap-sub" href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g" target="_blank">YouTube</a></li>
                                <li><a class="sitemap-sub" href="https://twitter.com/orangedataminer" target="_blank">Twitter</a></li>
                                <li><a class="sitemap-sub" href="https://datascience.stackexchange.com/questions/tagged/orange" target="_blank">Stack Exchange</a></li>
                                <li><a class="sitemap-sub" href="https://discord.gg/FWrfeXV" target="_blank">Discord</a></li>
                            </ul>

                        </div>

                    </div>
                </div>

                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-5 col-md-7 col-lg-6 sitemap-group docs-devs">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Documentation</div></li>
                                <li><a class="sitemap-sub" href='/getting-started/'>Get started</a></li>
                                <li><a class="sitemap-sub" href="/widget-catalog/">Widgets</a></li>
                                <li><a class="sitemap-sub" href="http://docs.biolab.si/3/data-mining-library/">Scripting</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-3 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Developers</div></b></li>
                                <li><a class="sitemap-sub" target="_blank" href="https://github.com/biolab/orange3">GitHub</a></li>
                            </ul>
                        </div>

                    </div>
                </div>

                <div class="col-md-5 col-sm-12 col-xs-12 sitemap-group">
                    <div class="latest-blog-posts">
                        <ul class="links list-sitemap" style="padding-bottom: 10px">
                            <li><b><a class="sitemap-cat" href="/blog/">Latest blog posts</a></b></li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 11 Jan </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2021/2021-01-11-orange-in-classroom/">Orange in Classroom</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 21 Dec </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2020/2020-12-21-year-in-code/">2020 - Year in Code</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 15 Oct </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2020/2020-10-15-document-embedders/">How to identify fake news with document embeddings</a>
                            </div>
                            </div>
                            </li>
                            
                        </ul>
                    </div>
                </div>

            </div>

            <div class="row footer-pad">
                <div class="col-xs-12">
                    <small class="copyright pull-left"  >Copyright © University of Ljubljana</small>
                </div>
            </div>
        </div>
    </footer>

    </body>
</html>