<html><head><title>Orange Data Mining - Data Mining COVID-19 Epidemics: Part 3</title><meta property="og:title" content="Data Mining COVID-19 Epidemics: Part 3"><meta property="og:description" content="Inspection of Covid-19 time trends."><meta property="og:image" content="/blog_img/2020/2020-04-15-thumb-log-growth.png"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Orange Data Mining Toolbox"><meta name=author content="Bioinformatics Laboratory, University of Ljubljana"><meta name=google-site-verification content="DS7GH5M7ABi78pIC2rMcTBFx-UeBFObXOeLvR7Ow3EQ"><link rel="shortcut icon" href=/images/favicon.ico><link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel=stylesheet type=text/css><link href='https://fonts.googleapis.com/css?family=Covered+By+Your+Grace' rel=stylesheet type=text/css><link rel=stylesheet href=/plugins/bootstrap/css/bootstrap.min.css><link rel=stylesheet href=/plugins/font-awesome/css/font-awesome.css><link rel=stylesheet href=/plugins/lightgallery/css/lightgallery.css><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css rel=stylesheet><link rel=stylesheet href=/scss/main.58e8531e166454b3665e4c7132aa2f1762a5569c179efa4bbf56b266ce93bfac.css><script id=dsq-count-scr src=//orange-4.disqus.com/count.js async></script><noscript><style>.jsonly{display:none!important}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-J6PJZF75EX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-J6PJZF75EX",{anonymize_ip:!1})}</script><script type=text/javascript src=/plugins/jquery-1.10.2.min.js></script>
<script type=text/javascript src=/plugins/jquery.form.js></script>
<script type=text/javascript src=/plugins/bootstrap/js/bootstrap.min.js></script>
<script type=text/javascript src=/plugins/lightgallery/js/lightgallery.js></script>
<script type=text/javascript src=/plugins/lightgallery/js/lg-thumbnail.js></script>
<script type=text/javascript src=/plugins/lightgallery/js/lg-video.js></script>
<script type=text/javascript src=/plugins/lightgallery/js/lg-zoom.js></script>
<script type=text/javascript src=/js/custom.js></script>
<script type=text/javascript src=/js/header_helpers.js></script>
<script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-T5X4T27")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5X4T27" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script type=text/javascript>$(document).ready(function(){$("a").off("click").click(function(e){ga("send","event","a",e.type,$(this).attr("id"),1)}),$("[class *= trackClicks_]").off("click").click(function(e){var n=$(this).attr("class").split(/\s+/),t="";$.each(n,function(e,n){n.indexOf("trackClicks_")===0&&(t=n)}),ga("send","event","a",e.type,t,1)})})</script></head><body><header id=top class="header navbar-fixed-top"><div class=container><h1 class="logo pull-left"><a id=header-orangelogo href=/><img id=logo-image class=logo-image src=/images/orange_logo_hq.png alt=Logo></a></h1><nav id=main-nav class="main-nav navbar-right" role=navigation><div class=navbar-header><button class=navbar-toggle type=button data-toggle=collapse data-target=#navbar-collapse>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="navbar-collapse collapse" id=navbar-collapse><ul class="nav navbar-nav"><li class=nav-item><a id=header-screenshots-link href=/screenshots/>Screenshots</a></li><li class=nav-item><a id=header-screenshots-link href=/workflows/>Workflows</a></li><li class=nav-item><a id=header-screenshots-link href=/download/>Download</a></li><li class=nav-item><a id=header-screenshots-link href=/blog/>Blog</a></li><li class=nav-item><a id=header-screenshots-link href=/docs/>Docs</a></li><li class=nav-item><a id=header-screenshots-link href=/training/>Workshops</a></li><li class=nav-search-wrapper><div><a class="btn nav-btn-search btn-warning nav-btn fa fa-search nav-btn-desktop" id=search-btn-js role=button></a><a class="btn nav-btn-search btn-warning nav-btn fa fa-search nav-btn-mobile" role=button href="/search/?q="></a><input type=text class="header-search-input jsonly search-widget-workflow nav-item" id=search-header placeholder=Search tabindex=1 onkeydown=check_key_header(event) hidden autofocus></div></li><li><div class="donate-button transform_header donate_div"><a class="btn btn-warning nav-btn" id=header-donate-link role=button target=_blank href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J">Donate</a></div></li></ul></div></nav></div></header><div id=main><div class="container-fluid clear-top"><div id=overflow-container class=overflow-container><div id=loop-container class="offset-header container"><div class="blog-font-size post type-post status-publish format-standard category-standard category-travel full-without-featured odd excerpt-1 no-image"><div class="entry-meta remove-padding-l-r"><span>Categories:</span>
<span class=category><a href=/blog/covid-19>covid-19</a></span>
<span class=category><span>|</span>
<a href=/blog/visualization>visualization</a></span>
<span class=category><span>|</span>
<a href=/blog/addons>addons</a></span>
<span class=category><span>|</span>
<a href=/blog/trends>trends</a></span>
<span class=category><span>|</span>
<a href=/blog/time>time</a></span></div><div class='entry-header remove-padding-l-r'><h1 class=entry-title>Data Mining COVID-19 Epidemics: Part 3</h1><span class=author-blog>By: Andreja Kovačič,
Apr 20, 2020</span></div><div class="entry-container remove-padding-l-r"><div class="entry-content md"><article><div id=blog_images_><p>So far, we&rsquo;ve seen how to make <a href=https://orange.biolab.si/blog/2020/2020-04-02-covid-19-basic/>basic visualizations</a> related to the corona virus and how to look at the <a href=https://orange.biolab.si/blog/2020/2020-04-09-covid-19-part-2/>disease progression on the map</a>. Be sure to check them out first, before delving into this one.</p><p>We are now heading towards somewhat more advanced visualizations that let us observe trends in the data. Just as a heads up: your results may be different, depending on the day you downloaded the data. We are working with confirmed cases up to April 13, on the previously mentioned data from the John Hopkins University.</p><h2 id=prerequisite-timeseries-add-on>Prerequisite: Timeseries add-on</h2><p>The spread of the virus is influenced by many factors, time being one of them. Timeseries add-on specializes in manipulation of time-related data. If you followed our blogs, you should already have it installed. If you don&rsquo;t, just take a peek in the <a href=https://orange.biolab.si/blog/2020/2020-04-09-covid-19-part-2/>second one</a>.</p><h2 id=formatting-the-data-as-timeseries>Formatting the data As Timeseries</h2><p>We&rsquo;ll load our data as usual with the File widget. The data contains latitude and longitude columns, which are just getting in the way in our further analysis. We will use Select Columns to put them into meta columns and thus exclude them from any calculations. Then we&rsquo;ll select some countries we are interested in with the help of the Data Table. You could also do it straight after inspecting the data in Geo Map.</p><a href=/blog_img/2020/2020-04-15-wf1.png class=blog-image_><img src=/blog_img/2020/2020-04-15-wf1.png class=workflow-screenshot></a><p>Now we just need to tell Orange, which variable contains time stamps. Our dates are represented as columns instead of as rows, so we&rsquo;ll use Transpose widget to make each row represent a datum and then connect it to As Timeseries Widget. In Transpose, we set the variable whose values will be used to name the rows when they are turned into columns. We&rsquo;ll name them by the column Country, as shown in the image, since the Province field is mostly empty. In As Timeseries, we set <em>sequence as implied by instance order</em>.</p><a href=/blog_img/2020/2020-04-15-as_timeseries.png class=blog-image_><img src=/blog_img/2020/2020-04-15-as_timeseries.png class=window-screenshot></a><p>Here is our chain of widgets. We should now be ready to start making some plots. Phew.</p><a href=/blog_img/2020/2020-04-15-first-snake.png class=blog-image_><img src=/blog_img/2020/2020-04-15-first-snake.png></a><h2 id=line-chart-and-log-plot>Line Chart and log plot</h2><p>Make sure you&rsquo;ve selected countries you are interested in the Data Table. I&rsquo;ve chosen Italy, US, Iran, France and Chinese province Hubei. Then, connect As Timeseries widget and Line Chart and let&rsquo;s get plotting. Once in Line Chart, we can select multiple countries by clicking Ctrl/Cmd and draw them on the same axis or we could compare multiple plots by clicking on Add plot.</p><a href=/blog_img/2020/2020-04-15-line-chart1.png class=blog-image_><img src=/blog_img/2020/2020-04-15-line-chart1.png></a><p>Here, we see how the virus started its path in China, where the number of cases quickly rose but has since then stayed level. Other countries were hit later on. The slopes of the curves tell us how fast the numbers are growing, but more on that later. One thing to notice though: due to the fast growth of the virus in some countries, some smaller slopes are almost invisible. We can remedy that by checking the Logarithmic axis box just like this:</p><a href=/blog_img/2020/2020-04-15-log-linechart.png class=blog-image_><img src=/blog_img/2020/2020-04-15-log-linechart.png></a><p>We can now see the first steps as well as the current situation.</p><h3 id=python-script>Python Script</h3><p>We can see from these plots, that different countries came into contact with the virus at different times. It seems it would be much easier to compare the curves if all of them started their climb at the same time. We can do that with just a few lines of code. Example snippet here aligns the curves with the moment where the country recorded 100 cases. You can set n to any other (positive) number if you will, though.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> copy <span style=color:#f92672>import</span> deepcopy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>out_data <span style=color:#f92672>=</span> deepcopy(in_data)
</span></span><span style=display:flex><span>out_data<span style=color:#f92672>.</span>X[out_data<span style=color:#f92672>.</span>X <span style=color:#f92672>&lt;</span> n] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>ar <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>argwhere(out_data<span style=color:#f92672>.</span>X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cols, shifts <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>unique(ar[:, <span style=color:#ae81ff>1</span>], return_counts<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>out_data<span style=color:#f92672>.</span>X <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([np<span style=color:#f92672>.</span>roll(out_data<span style=color:#f92672>.</span>X[:, col], shift) <span style=color:#66d9ef>for</span> col, shift <span style=color:#f92672>in</span> zip(cols, shifts)])<span style=color:#f92672>.</span>T
</span></span><span style=display:flex><span>out_data<span style=color:#f92672>.</span>X[out_data<span style=color:#f92672>.</span>X<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>]<span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>nan
</span></span></code></pre></div><p>Copy these lines into Python Script widget, and plug it into our initial snake of widgets like so:
<a href=/blog_img/2020/2020-04-15-snake-pyscript.png class=blog-image_><img src=/blog_img/2020/2020-04-15-snake-pyscript.png></a></p><p>Look at the aligned curves now, they are much easier to compare.
<a href=/blog_img/2020/2020-04-15-script-log-lc.png class=blog-image_><img src=/blog_img/2020/2020-04-15-script-log-lc.png></a></p><h3 id=absolute-growth-with-derivative>Absolute growth with derivative</h3><p>Let&rsquo;s take a look at how fast the confirmed cases are spreading. Connect As Timeseries with Difference widget, choose Differencing and select countries of interest. Differencing order of 1 means we&rsquo;ll be looking at derivative of first order, which just means daily change in our case. We&rsquo;ll leave shift as is, on 1.</p><a href=/blog_img/2020/2020-04-15-diff-settings.png class=blog-image_><img src=/blog_img/2020/2020-04-15-diff-settings.png class=window-screenshot></a><p>Again, we&rsquo;ll view the transformed curves in Line Chart. Notice how the difference (and every other) transform adds a new column? That means we can compare our curves in different states, so be sure to always check what is being shown. For starters, try looking at, for example, China and its transformed version. See how easy it is to spot the daily spikes that are perhaps out of the ordinary and need to be checked? The most prominent spike here is probably due to the change in counting.</p><a href=/blog_img/2020/2020-04-15-china-dif.png class=blog-image_><img src=/blog_img/2020/2020-04-15-china-dif.png></a><p>If we again compare multiple countries, we notice the US&rsquo;s speedy climb and Iran seemingly being more successful in curbing the growth.</p><a href=/blog_img/2020/2020-04-15-diff-compare.png class=blog-image_><img src=/blog_img/2020/2020-04-15-diff-compare.png></a><p>The difference could be only due to the difference in population and what is an overwhelmingly large number of patients for one country might be almost business as usual for another one.</p><h3 id=scale-free-growth-with-quotient>Scale free growth with quotient</h3><p>Difference widget also has the option to output the quotients. It will allow us to observe the relative growth and compare countries directly.</p><a href=/blog_img/2020/2020-04-15-quot-settings.png class=blog-image_><img src=/blog_img/2020/2020-04-15-quot-settings.png class=window-screenshot></a><p>Let&rsquo;s look at, for example, China (Hubei province) vs France.</p><a href=/blog_img/2020/2020-04-15-china-fr-quot.png class=blog-image_><img src=/blog_img/2020/2020-04-15-china-fr-quot.png></a><p>It seems China is doing worse in the beginning and better later on, but it is impossible to tell at which point the trends start to shift. There are just too many jumps, due to noise in testing and reporting. So for our final step, let&rsquo;s smooth things out.</p><h3 id=moving-transform-and-smoothing>Moving transform and smoothing</h3><p>Smoothing is usually a part of preprocessing, so insert the Moving Transform widget between As Timeseries and Difference, and add some moving average transforms, like this:</p><a href=/blog_img/2020/2020-04-15-wf3.png class=blog-image_><img src=/blog_img/2020/2020-04-15-wf3.png class=workflow-screenshot></a>
<a href=/blog_img/2020/2020-04-15-mt-settings.png class=blog-image_><img src=/blog_img/2020/2020-04-15-mt-settings.png class=window-screenshot></a><p>Selecting now smoothened China and the France data in Difference widget, yields the following plot in Line Chart:</p><a href=/blog_img/2020/2020-04-15-china-fr-quot-sm.png class=blog-image_><img src=/blog_img/2020/2020-04-15-china-fr-quot-sm.png></a><p>The trends now seem clearer. The countries have somewhat similar trends up to 15th day, when China&rsquo;s growth falls decisively below the French.</p><p>Quotient plot obviously benefited from smoothing, as did the difference plot. For completeness, we added another Difference widget after Moving Transform, and plotted now smoothed difference between the two countries. Notice how the turning point is now seemingly further down the line. Orange prides itself on interactivity, so just by sliding the mouse over the plot, we get the exact information regarding the days and counts. The turning point seems to be on the 25th day.</p><a href=/blog_img/2020/2020-04-15-china-fr-diff-sm.png class=blog-image_><img src=/blog_img/2020/2020-04-15-china-fr-diff-sm.png></a><p>This blog concludes our Corona virus series for now. Until our next blog, stay safe.</p><a href=/blog_img/2020/2020-04-15-final-workflow.png class=blog-image_><img src=/blog_img/2020/2020-04-15-final-workflow.png></a><hr><p>Orange is a multi-platform open-source machine learning and data visualization tool for beginners and experts alike. <a href=https://orange.biolab.si/download>Download Orange</a>, and load and explore your own data sets!</p><p>In addition to a variety of learning materials posted online in the form of
<a href=https://orange.biolab.si/blog/>blog posts</a>, <a href="https://www.youtube.com/playlist?list=PLmNPvQr9Tf-ZSDLwOzxpvY-HrE0yv-8Fy">tutorial videos</a>, we&rsquo;ve created a Discord server. <a href=https://discord.gg/FWrfeXV>Join the community, tell us what you think!</a></p></div></article></div></div></div></div></div><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://orange-4.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><script type=text/javascript>$(document).ready(function(){$("#blog_images_").lightGallery({thumbnail:!1,selector:"a:has(img)",width:"60%",mode:"lg-fade",counter:!1,download:!1,enableSwipe:!1,enableDrag:!1,speed:1,useLeft:!0,hideBarsDelay:1e3})})</script></div></div><footer class=footer><div class=container><div class=row><div class="col-md-4 col-sm-6 col-xs-12"><div class=row><div class="col-sm-4 sitemap-group"><ul class="links list-sitemap"><li><b><div class=sitemap-cat>Orange</div></b></li><li><a class=sitemap-sub href=/faq/>FAQ</a></li><li><a class=sitemap-sub href=/license/>License</a></li><li><a class=sitemap-sub href=/privacy/>Privacy</a></li><li><a class=sitemap-sub href=/citation/>Citation</a></li><li><a class=sitemap-sub href=/contact/>Contact</a></li></ul></div><div class="col-sm-4 sitemap-group"><ul class="links list-sitemap"><li><div class=sitemap-cat>Download</div></li><li><a class=sitemap-sub href=/download/#windows>Windows</a></li><li><a class=sitemap-sub href=/download/#macos>Mac OS</a></li></ul></div><div class="col-sm-4 sitemap-group"><ul class="links list-sitemap"><li><b><div class=sitemap-cat>Community</div></b></li><li><a class=sitemap-sub href=https://www.facebook.com/orangedatamining target=_blank>Facebook</a></li><li><a class=sitemap-sub href=https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g target=_blank>YouTube</a></li><li><a class=sitemap-sub href=https://twitter.com/orangedataminer target=_blank>Twitter</a></li><li><a class=sitemap-sub href=https://datascience.stackexchange.com/questions/tagged/orange target=_blank>Stack Exchange</a></li><li><a class=sitemap-sub href=https://discord.gg/FWrfeXV target=_blank>Discord</a></li></ul></div></div></div><div class="col-md-3 col-sm-6 col-xs-12"><div class=row><div class="col-sm-5 col-md-7 col-lg-6 sitemap-group docs-devs"><ul class="links list-sitemap"><li><div class=sitemap-cat>Documentation</div></li><li><a class=sitemap-sub href=/getting-started/>Get started</a></li><li><a class=sitemap-sub href=/widget-catalog/>Widgets</a></li><li><a class=sitemap-sub href=http://docs.biolab.si/3/data-mining-library/>Scripting</a></li></ul></div><div class="col-sm-3 sitemap-group"><ul class="links list-sitemap"><li><b><div class=sitemap-cat>Developers</div></b></li><li><a class=sitemap-sub target=_blank href=https://github.com/biolab/orange3>GitHub</a></li><li><a class=sitemap-sub target=_blank href=http://docs.biolab.si/3/development/>Getting Started</a></li></ul></div></div></div><div class="col-md-5 col-sm-12 col-xs-12 sitemap-group"><div class=latest-blog-posts><ul class="links list-sitemap" style=padding-bottom:10px><li><b><a class=sitemap-cat href=/blog/>Latest blog posts</a></b></li><li><div class=row><div class=col-md-2><a class=sitemap-sub>19 Sep</a></div><div class=col-md-10><a class=sitemap-sub style=color:#f79211 href=/blog/2023/2023-09-19-fairness-reweighing-preprocessor/>Orange Fairness - Reweighing as a preprocessor</a></div></div></li><li><div class=row><div class=col-md-2><a class=sitemap-sub>19 Sep</a></div><div class=col-md-10><a class=sitemap-sub style=color:#f79211 href=/blog/2023/2023-09-19-fairness-reweighing-dataset/>Orange Fairness - Reweighing a Dataset</a></div></div></li><li><div class=row><div class=col-md-2><a class=sitemap-sub>18 Sep</a></div><div class=col-md-10><a class=sitemap-sub style=color:#f79211 href=/blog/2023/2023-09-18-fairness-dataset-bias/>Orange Fairness - Dataset Bias</a></div></div></li></ul></div></div></div><div class="row footer-pad"><div class=col-xs-12><small class="copyright pull-left">Copyright © University of Ljubljana</small></div></div></div></footer></body></html>