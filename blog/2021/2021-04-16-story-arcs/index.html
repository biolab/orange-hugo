<html>    
    <head>
    <title>Orange Data Mining - Detecting Story Arcs with Orange</title>

    
    
    <meta property="og:title" content="Detecting Story Arcs with Orange">
    
    
    <meta property="og:description" content="How to detect and analyze story arcs in a corpus.">
    
    
    <meta property="og:image" content="/blog_img/2020/2020-07-27-story-arcs-small.png">
    

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Orange Data Mining Toolbox">
    <meta name="author" content="Bioinformatics Laboratory, University of Ljubljana">
    <meta name="google-site-verification" content="DS7GH5M7ABi78pIC2rMcTBFx-UeBFObXOeLvR7Ow3EQ" />
    <link rel="shortcut icon" href="/images/favicon.ico">
    
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Covered+By+Your+Grace' rel='stylesheet' type='text/css'>
    
    <link rel="stylesheet" href="/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/plugins/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="/plugins/lightgallery/css/lightgallery.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/build/css/styles.min.css">
    <script id="dsq-count-scr" src="//orange-4.disqus.com/count.js" async></script>

     <script src="https://www.recaptcha.net/recaptcha/api.js" async defer></script>
    <noscript>
        <style>
            .jsonly { display: none !important; }
        </style>
    </noscript>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-528382-1', 'auto');
      ga('require', 'linkid');
      ga('send', 'pageview');


    </script>




    <script type="text/javascript" src="/plugins/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/plugins/jquery.form.js"></script>
    <script type="text/javascript" src="/plugins/bootstrap/js/bootstrap.min.js"></script>
    
    <script type="text/javascript" src="/plugins/lightgallery/js/lightgallery.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-thumbnail.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-video.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-zoom.js"></script>
    <script type="text/javascript" src="/js/custom.js"></script>
    <script type="text/javascript" src="/js/header_helpers.js"></script>


    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5X4T27');</script>
    

    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5X4T27"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    

    
    <script type="text/javascript">
      $( document ).ready( function () {

        $('a').off("click").click( function ( event ) {
           ga('send', 'event', "a", event.type, $(this).attr("id"), 1 );
        });

        $('[class *= trackClicks_]').off("click").click( function ( event ) {
           var classList = $(this).attr('class').split(/\s+/);
           var trackname = "";
           $.each(classList, function(index, item) {
             if (item.indexOf('trackClicks_') === 0) {
                trackname = item;
             }
           });
           ga('send', 'event', "a", event.type, trackname, 1 );
        });
      });
    </script>

</head>

    <body>

     <header id="top" class="header navbar-fixed-top">
        <div class="container" >
            <h1 class="logo pull-left" >
                <a id="header-orangelogo" href="/">
                    <img id="logo-image" class="logo-image" src="/images/orange_logo_hq.png" alt="Logo">
                </a>
            </h1>
            <nav id="main-nav" class="main-nav navbar-right" role="navigation">
                <div class="navbar-header">
                    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
               <div class="navbar-collapse collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">

                        

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/screenshots/">Screenshots</a></li>
                            
                        
                      
                    

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/workflows/">Workflows</a></li>
                            
                        
                      
                    

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/download/">Download</a></li>
                            
                        
                      
                    

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/blog/">Blog</a></li>
                            
                        
                      
                    

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/docs/">Docs</a></li>
                            
                        
                      
                    

                        
                        
                            
                            <li class="nav-item"><a id="header-screenshots-link"  href="/training/">Workshops</a></li>
                            
                        
                      
                    

                        
                              <li class="input_search nav-item">
                                <div class="header-search-input transform_header" hidden>
                                  <input type="text" class="jsonly search-widget-workflow nav-item" id="search-header" style="margin-top: 8px" placeholder="Search" tabindex="1" onkeydown="check_key_header(event)" autofocus />
                                </div>
                              </li>
                              <li class="">
                                <div class="">

                                <a class="btn header-search-button btn-warning big-button-base donate fa fa-search" id="searchBtn" role="button" onClick="header_search()">

                                </a>
                              </div>
                              </li>
                        
                    

                        
                        
                            
                        <li class="">
                          <div class="donate-button transform_header donate_div" hidden>
                            <a class="btn btn-warning big-button-base donate" id="header-donate-link" role="button" target="_blank" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J">Donate</a>
                          </div>
                        </li>
                            
                        
                      
                    
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <div id="main">
        <div class="container-fluid clear-top">
            
<div id="overflow-container" class="overflow-container">
  <div id="loop-container" class="offset-header container">
    
      <div
        class="blog-font-size post type-post status-publish format-standard category-standard category-travel full-without-featured odd excerpt-1 no-image">
        
        <div class="entry-meta remove-padding-l-r">
          <span>Categories: </span>
          
          <span class="category">
            
            <a href="/blog/text-mining">text mining</a>
          </span>
          
          <span class="category">
            
            <span> | </span>
            
            <a href="/blog/sentiment-analysis">sentiment analysis</a>
          </span>
          
          <span class="category">
            
            <span> | </span>
            
            <a href="/blog/corpus">corpus</a>
          </span>
          
          <span class="category">
            
            <span> | </span>
            
            <a href="/blog/story-arc">story arc</a>
          </span>
          
          <span class="category">
            
            <span> | </span>
            
            <a href="/blog/heat-map">heat map</a>
          </span>
          
          <span class="category">
            
            <span> | </span>
            
            <a href="/blog/line-chart">line chart</a>
          </span>
          
        </div>
        <div class='entry-header remove-padding-l-r'>
          <h1 class='entry-title'> Detecting Story Arcs with Orange</h1>
          <span class="author-blog">
            
            By: Ajda Pretnar,
            
            Apr 16, 2021
          </span>
        </div>
        <div class="entry-container remove-padding-l-r">
          <div class="entry-content md">
            <article>
              <div id="blog_images_">


              <p>Reading is fun because it takes you on a journey. Mostly, it is a journey of emotions as you live and breathe with the protagonist and her adventures. Today, we will have a look at how to detect sentiment in a story, plot story arcs and analyze the content of the key segments in a corpus.</p>
<p>Related: <a href="/blog/2018/09/11/text-workshops-in-ljubljana/" target="_blank">Text Workshops in Ljubljana</a></p>
<p>We will be using a corpus of Anderson&rsquo;s tales, which is available in the <strong>Corpus</strong> widget (data set <em>anderson.tab</em>). Load it in the widget. Next, we will select a single tale which we will analyze, say, Little Match Seller. Connect Corpus to <strong>Data Table</strong> and select the tale. We all know the story of a little girl selling matches on a New Year&rsquo;s Eve and freezing to death. It is one of the saddest stories ever told. One could almost forget there are positive parts, such as the girl&rsquo;s visions in the moments before her death, which show a glimmer of hope, the only consolation the girl had in her life. Let us verify this in Orange.</p>
<a href="/blog_img/2020/2020-07-27-corpus.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-corpus.png" class="window-screenshot" />
 </a>


<a href="/blog_img/2020/2020-07-27-data-table.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-data-table.png" class="window-screenshot" />
 </a>



<a href="/blog_img/2020/2020-07-27-wf1.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-wf1.png" class="workflow-screenshot" />
</a>


<p>With our story selected, we have to split it into sentences. At the moment, our story is a single row in the data, but we wish to have each sentence in its own row. We will use <strong>Preprocess Text</strong> and select Sentence tokenization. I have removed the redundant preprocessors and kept the only one we need.</p>
<a href="/blog_img/2020/2020-07-27-preprocess.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-preprocess.png" class="window-screenshot" />
 </a>


<p>Some Python magic will help us create a new corpus from the existing tokens (sentences). Copy and paste the script below into the <strong>Python Script</strong> widget. Do not forget to press <strong>Run</strong> once you have pasted the script into the widget.</p>
<pre><code>import numpy as np
from Orange.data import Domain, StringVariable
from orangecontrib.text.corpus import Corpus

tokens = in_data.tokens
new_domain = Domain(attributes=[], metas=[StringVariable('Sentences'), StringVariable('Title')])

titles = []
content = []

for i, doc in enumerate(tokens):
    for t in doc:
        titles.append(in_data[i]['Title'].value)
        content.append(t)

metas = np.column_stack((content, titles))
out_data = Corpus.from_numpy(domain=new_domain, X=np.empty((len(content), 0)),
                            metas=metas)
out_data.set_text_features([StringVariable('Sentences')])
</code></pre>

<a href="/blog_img/2020/2020-07-27-wf2.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-wf2.png" class="workflow-screenshot" />
</a>


<p>Perfect, our data is now ready for the final step. Add another Preprocess Text and keep the default preprocessors. They will lowercase our sentences, split by words and remove English stopwords.</p>
<a href="/blog_img/2020/2020-07-27-preprocess2.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-preprocess2.png" class="window-screenshot" />
 </a>


<p>Finally, add the <strong>Sentiment Analysis</strong> widget. By default, the widget uses the Vader algorithm, which works quite well for English. Please note that it won&rsquo;t work for other languages, as all of Orange&rsquo;s sentiment models are language specific. You can use Multilingual sentiment for non-English texts.</p>
<a href="/blog_img/2020/2020-07-27-sentiment-analysis.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-sentiment-analysis.png" class="window-screenshot" />
 </a>



<a href="/blog_img/2020/2020-07-27-wf3.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-wf3.png" class="workflow-screenshot" />
</a>


<p>At last, it is time to analyze the data. We will use <a href="https://github.com/biolab/orange3-timeseries">Timeseries add-on</a> to plot sequential data. First, we will pass the data to the <strong>As Timeseries</strong> widget and set the <em>Sequence implied by the instance order</em> option. This tells Orange that our data is already ordered by time - in our case, by the order in which each sentence appears in the story.</p>
<a href="/blog_img/2020/2020-07-27-as-timeseries.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-as-timeseries.png" class="window-screenshot" />
 </a>


<p>Connect <strong>Line Chart</strong> to As Timeseries. In the widget, select <em>Compound</em> variable, which shows the total sentiment of each sentence. The peaks represent the parts of the story with positive emotions and the drops the parts with the negative ones.</p>
<a href="/blog_img/2020/2020-07-27-line-chart.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-line-chart.png" class="window-screenshot" />
 </a>



<a href="/blog_img/2020/2020-07-27-wf4.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-wf4.png" class="workflow-screenshot" />
</a>


<p>To explore the data in depth, connect <strong>Heat Map</strong> to Sentiment Analysis. Heat Map will show all 4 sentiment attributes, namely positive (pos), negative (neg), neutral (neu) and   compound sentiment. But our data is all over the place. Let us order it. Select <em>Clustering (opt. ordering)</em> under the Clustering - Rows option. This will cluster the sentences by their similarity, specifically by how similar their emotion is.</p>
<a href="/blog_img/2020/2020-07-27-heat-map.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-heat-map.png" class="window-screenshot" />
 </a>


<p>Great! Now this looks like something useful. The blue sections represent the negative sentences, while the yellow and white sections represent the positive ones. Let us select the cluster with negative sentences and observe it in a <strong>Corpus Viewer</strong>.</p>
<a href="/blog_img/2020/2020-07-27-negative-sentiment.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-negative-sentiment.png" class="window-screenshot" />
 </a>



<a href="/blog_img/2020/2020-07-27-wf5.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-wf5.png" class="workflow-screenshot" />
</a>


<p>I have set Sentences as the single Display variable and selected all the sentences to show them in a list. Unsurprisingly, here is the last sentence of the story, in which a girl if found dead in the street on a New Year&rsquo;s Day.</p>
<p>To finish, let us explore the positive sentences, too. Select the positive section in the Heat Map and observe it in a Corpus Viewer. Now rethink the story, reread her visions in the last moments of her life and how happy she was when she died. Couldn&rsquo;t we say that &hellip; the story has a happy ending?</p>
<a href="/blog_img/2020/2020-07-27-positive-sentiment.png" class="blog-image_"> 
      <img src="/blog_img/2020/2020-07-27-positive-sentiment.png" class="window-screenshot" />
 </a>


<p>While the workflow is quite long, it is conceptually very simple. This is a quick and easy way to explore the story arcs and sentiment in a text. We imagine this to be a very useful tool for the teachers who wish to experiment a bit in their language classes and offer a fun and fruitful way of exploring literature.</p>

<a href="/blog_img/2020/2020-07-27-final-workflow.png" class="blog-image_">
      <img src="/blog_img/2020/2020-07-27-final-workflow.png" class="workflow-screenshot" />
</a>



            </div>
            </article>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://orange-4.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#blog_images_').lightGallery({
        thumbnail: false,
        selector: 'a:has(img)',
        width: '60%',
        mode: 'lg-fade',
        counter: false,
        download: false,
        enableSwipe: false,
        enableDrag: false,
        speed: 1,
        useLeft: true,
        hideBarsDelay: 1000
    });
    });
</script>

        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <div class="row">

                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Orange</div></b></li>
                                <li><a class="sitemap-sub" href="/faq/">FAQ</a></li>
                                <li><a class="sitemap-sub" href="/license/">License</a></li>
                                <li><a class="sitemap-sub" href="/privacy/">Privacy</a></li>
                                <li><a class="sitemap-sub" href="/citation/">Citation</a></li>
                                <li><a class="sitemap-sub" href="/contact/">Contact</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Download</div></li>
                                <li><a class="sitemap-sub" href="/download/#windows">Windows</a></li>
                                <li><a class="sitemap-sub" href="/download/#macos">Mac OS</a></li>
                                
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">

                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Community</div></b></li>
                                <li><a class="sitemap-sub" href="https://www.facebook.com/orangedatamining" target="_blank">Facebook</a></li>
                                <li><a class="sitemap-sub" href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g" target="_blank">YouTube</a></li>
                                <li><a class="sitemap-sub" href="https://twitter.com/orangedataminer" target="_blank">Twitter</a></li>
                                <li><a class="sitemap-sub" href="https://datascience.stackexchange.com/questions/tagged/orange" target="_blank">Stack Exchange</a></li>
                                <li><a class="sitemap-sub" href="https://discord.gg/FWrfeXV" target="_blank">Discord</a></li>
                            </ul>

                        </div>

                    </div>
                </div>

                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-5 col-md-7 col-lg-6 sitemap-group docs-devs">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Documentation</div></li>
                                <li><a class="sitemap-sub" href='/getting-started/'>Get started</a></li>
                                <li><a class="sitemap-sub" href="/widget-catalog/">Widgets</a></li>
                                <li><a class="sitemap-sub" href="http://docs.biolab.si/3/data-mining-library/">Scripting</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-3 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Developers</div></b></li>
                                <li><a class="sitemap-sub" target="_blank" href="https://github.com/biolab/orange3">GitHub</a></li>
                                <li><a class="sitemap-sub" target="_blank" href="http://docs.biolab.si/3/development/">Getting Started</a></li>
                            </ul>
                        </div>

                    </div>
                </div>

                <div class="col-md-5 col-sm-12 col-xs-12 sitemap-group">
                    <div class="latest-blog-posts">
                        <ul class="links list-sitemap" style="padding-bottom: 10px">
                            <li><b><a class="sitemap-cat" href="/blog/">Latest blog posts</a></b></li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 17 Sep </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2021/2021-09-17-semantic-analysis/">Semantic Analysis of Documents</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 15 Sep </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2021/2021-09-15-connlu-files/">New in Orange: Support for CONLL-U files</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 13 Aug </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2021/2021-08-13-apply-domain/">Why You Should Use Apply Domain</a>
                            </div>
                            </div>
                            </li>
                            
                        </ul>
                    </div>
                </div>

            </div>

            <div class="row footer-pad">
                <div class="col-xs-12">
                    <small class="copyright pull-left"  >Copyright © University of Ljubljana</small>
                </div>
            </div>
        </div>
    </footer>

    </body>
</html>