<html>    
    <head>
    <title>Orange Data Mining - Meet Trubar, a friend of Orange</title>

    
    
    <meta property="og:title" content="Meet Trubar, a friend of Orange">
    
    
    <meta property="og:description" content="A new, general utility for localization of Python software">
    
    
    <meta property="og:image" content="/blog_img/2023/2023-01-17-primoz-trubar.png">
    

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Orange Data Mining Toolbox">
    <meta name="author" content="Bioinformatics Laboratory, University of Ljubljana">
    <meta name="google-site-verification" content="DS7GH5M7ABi78pIC2rMcTBFx-UeBFObXOeLvR7Ow3EQ" />
    <link rel="shortcut icon" href="/images/favicon.ico">
    
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Covered+By+Your+Grace' rel='stylesheet' type='text/css'>
    
    <link rel="stylesheet" href="/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/plugins/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="/plugins/lightgallery/css/lightgallery.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    
    
    
    <link rel="stylesheet" href="/scss/main.58e8531e166454b3665e4c7132aa2f1762a5569c179efa4bbf56b266ce93bfac.css">
    <script id="dsq-count-scr" src="//orange-4.disqus.com/count.js" async></script>

    <noscript>
        <style>
            .jsonly { display: none !important; }
        </style>
    </noscript>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-528382-1', 'auto');
      ga('require', 'linkid');
      ga('send', 'pageview');


    </script>




    <script type="text/javascript" src="/plugins/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/plugins/jquery.form.js"></script>
    <script type="text/javascript" src="/plugins/bootstrap/js/bootstrap.min.js"></script>
    
    <script type="text/javascript" src="/plugins/lightgallery/js/lightgallery.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-thumbnail.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-video.js"></script>
    <script type="text/javascript" src="/plugins/lightgallery/js/lg-zoom.js"></script>
    <script type="text/javascript" src="/js/custom.js"></script>
    <script type="text/javascript" src="/js/header_helpers.js"></script>


    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5X4T27');</script>
    

    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5X4T27"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    

    
    <script type="text/javascript">
      $( document ).ready( function () {

        $('a').off("click").click( function ( event ) {
           ga('send', 'event', "a", event.type, $(this).attr("id"), 1 );
        });

        $('[class *= trackClicks_]').off("click").click( function ( event ) {
           var classList = $(this).attr('class').split(/\s+/);
           var trackname = "";
           $.each(classList, function(index, item) {
             if (item.indexOf('trackClicks_') === 0) {
                trackname = item;
             }
           });
           ga('send', 'event', "a", event.type, trackname, 1 );
        });
      });
    </script>

</head>

    <body>

    <header id="top" class="header navbar-fixed-top">
  <div class="container" >
      <h1 class="logo pull-left" >
          <a id="header-orangelogo" href="/">
              <img id="logo-image" class="logo-image" src="/images/orange_logo_hq.png" alt="Logo">
          </a>
      </h1>
      <nav id="main-nav" class="main-nav navbar-right" role="navigation">
          <div class="navbar-header">
              <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
              </button>
          </div>
         <div class="navbar-collapse collapse" id="navbar-collapse">
              <ul class="nav navbar-nav">

                  

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/screenshots/">Screenshots</a></li>
                      
                  
                
              

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/workflows/">Workflows</a></li>
                      
                  
                
              

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/download/">Download</a></li>
                      
                  
                
              

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/blog/">Blog</a></li>
                      
                  
                
              

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/docs/">Docs</a></li>
                      
                  
                
              

                  
                  
                      
                      <li class="nav-item"><a id="header-screenshots-link"  href="/training/">Workshops</a></li>
                      
                  
                
              

                  
                      <li class="nav-search-wrapper">
                        <div>                         
                          
                          <a class="btn nav-btn-search btn-warning nav-btn fa fa-search nav-btn-desktop" 
                            id="search-btn-js" 
                            role="button">
                          </a>
                          
                          
                          <a class="btn nav-btn-search btn-warning nav-btn fa fa-search nav-btn-mobile" 
                            role="button" 
                            href="/search/?q=">
                          </a>

                          <input type="text" 
                                class="header-search-input jsonly search-widget-workflow nav-item" 
                                id="search-header" 
                                placeholder="Search" 
                                tabindex="1" 
                                onkeydown="check_key_header(event)" 
                                hidden
                                autofocus />
                        </div>
                      </li>
                  
              

                  
                  
                      
                  <li class="">
                    <div class="donate-button transform_header donate_div">
                      <a class="btn btn-warning nav-btn" id="header-donate-link" role="button" target="_blank" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=A76TAX87ZVR3J">Donate</a>
                    </div>
                  </li>
                      
                  
                
              
              </ul>
          </div>
      </nav>
  </div>
</header>

    <div id="main">
        <div class="container-fluid clear-top">
            
<div id="overflow-container" class="overflow-container">
  <div id="loop-container" class="offset-header container">
    
      <div
        class="blog-font-size post type-post status-publish format-standard category-standard category-travel full-without-featured odd excerpt-1 no-image">
        
        <div class="entry-meta remove-padding-l-r">
          <span>Categories: </span>
          
          <span class="category">
            
            <a href="/blog/development">development</a>
          </span>
          
        </div>
        <div class='entry-header remove-padding-l-r'>
          <h1 class='entry-title'> Meet Trubar, a friend of Orange</h1>
          <span class="author-blog">
            
            By: Janez Demšar,
            
            Jan 17, 2023
          </span>
        </div>
        <div class="entry-container remove-padding-l-r">
          <div class="entry-content md">
            <article>
              <div id="blog_images_">


              <p>Orange has been translated to Slovenian language (no official release yet: rough corners are very much being polished). This will pave the way for translations into other languages.</p>
<a href="/blog_img/2023/2023-01-17-table.png" class="blog-image_"> 
      <img src="/blog_img/2023/2023-01-17-table.png" class="window-screenshot" />
 </a>


<p>What do we use? Gettext, right? Wrong. Orange is written in modern Python and uses f-strings for string interpolation. They are great, but don&rsquo;t play well with gettext.</p>
<h2 id="why-gettext-doesnt-cut-it">Why gettext doesn&rsquo;t cut it</h2>
<p>If you&rsquo;ve never heard about gettext: <a href="https://www.gnu.org/software/gettext/">gettext</a> is a popular framework for software localization. Developers enclose every string that needs to be translated into a function call that translates it. The function would be called something short, like <code>_</code> or <code>tr</code>. One of gettext&rsquo;s utilities extracts all such strings into messages files. Translators provide translations. Messages are compiled into binary form and imported into the program. When function <code>_</code> (or <code>tr</code> or whatever) gets a string, it searches for a translation and returns it.</p>
<p>So in Python, a programmer would write <code>print(tr(&quot;Data contains {n} instances&quot;).format(n)))</code>. Translator would see the message <code>&quot;Data contains {n} instances&quot;</code> and provide a translation, for instance <code>&quot;Podatki vsebujejo {n} primerov.&quot;</code>. After messages are compiled and in their place, the function <code>tr</code> would receive the English message and return the Slovenian translation.</p>
<p>The above example uses the old-style interpolation with <code>format</code>. is does not work for Python&rsquo;s f-strings. With f-strings, we would have <code>print(tr(f&quot;Data contains {n} instances&quot;)</code>. The number, <code>n</code>, is interpolated before the function call, so <code>tr</code> already receives the entire string, like <code>&quot;Data contains 1234 instances&quot;</code>. This obviously doesn&rsquo;t match any pre-translated messages, because it includes a specific number. Call <code>tr</code> earlier? See, that&rsquo;s the thing: you can&rsquo;t. There is no such string as <code>&quot;Data contains {n} instances&quot;</code>. It is never &ldquo;materialized&rdquo;: in Python&rsquo;s abstract syntax tree, these are three distinct elements (a constant <code>&quot;Data contains &quot;</code>, expression <code>n</code>, and a constant <code> instance</code>). At the moment they are joined into an actual object (of type <code>str</code>) that can be passed to some function, the value of <code>n</code> is already interpolated.</p>
<p>Gettext-like approaches thus can&rsquo;t work on f-strings. To our knowledge, there is currently no tool to support translation of f-strings.</p>
<p>Luckily, we are programmers.</p>
<h2 id="enters-trubar">Enters Trubar</h2>
<p>We developed Trubar. Named after Primož Trubar (the author of the first Slovenian printed books, Catechismus and Abecedarium, and the first translator of part of the Bible in Slovenian language), Trubar collects all strings from sources and places them into a yaml-like file. There, they can be translated - or marked as strings that must not be translated. Then, Trubar copies the sources, substituting strings with their translations, if provided.</p>
<p>This is a part of the file related to the translation of the Table widget above.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">widgets/data/owtable.py</span>:
    <span style="color:#f92672">class `OWDataTable`</span>:
        <span style="color:#f92672">Data Table</span>: <span style="color:#ae81ff">Tabela</span>
        <span style="color:#f92672">icons/Table.svg</span>: <span style="color:#66d9ef">false</span>
        <span style="color:#f92672">class `Inputs`</span>:
            <span style="color:#f92672">Data</span>: <span style="color:#ae81ff">Podatki</span>
        <span style="color:#f92672">class `Outputs`</span>:
            <span style="color:#f92672">Selected Data</span>: <span style="color:#ae81ff">Izbor podatkov</span>
        <span style="color:#f92672">def `__init__`</span>:
            <span style="color:#f92672">Variables</span>: <span style="color:#ae81ff">Spremenljivke</span>
            <span style="color:#f92672">show_attribute_labels</span>: <span style="color:#66d9ef">false</span>
            <span style="color:#f92672">Show variable labels (if present)</span>: <span style="color:#ae81ff">Pokaži oznake spremenljivk</span>
            <span style="color:#f92672">show_distributions</span>: <span style="color:#66d9ef">false</span>
            <span style="color:#f92672">Visualize numeric values</span>: <span style="color:#ae81ff">Vizualiziraj številske vrednosti</span>
            <span style="color:#f92672">color_by_class</span>: <span style="color:#66d9ef">false</span>
            <span style="color:#f92672">Color by instance classes</span>: <span style="color:#ae81ff">Obarvaj primere glede na razred</span>
            <span style="color:#f92672">Selection</span>: <span style="color:#ae81ff">Izbor</span>
            <span style="color:#f92672">select_rows</span>: <span style="color:#66d9ef">false</span>
            <span style="color:#f92672">Select full rows</span>: <span style="color:#ae81ff">Izbiraj cele vrstice</span>
            <span style="color:#f92672">Restore Original Order</span>: <span style="color:#ae81ff">Izvirni vrstni red</span>
        <span style="color:#f92672">def `set_dataset`</span>:
            <span style="color:#f92672">name</span>: <span style="color:#66d9ef">false</span>
            <span style="color:#f92672">Data</span>: <span style="color:#ae81ff">Podatki</span>
</code></pre></div><p>If it looks simple, it&rsquo;s because <a href="http://janezd.github.io/trubar/getting-started/">it <em>is</em> simple</a>.</p>
<p>Besides working with f-strings, the advantage of Trubar&rsquo;s approach is that - unlike gettext - it does not pollute the sources with calls and parentheses. There&rsquo;s enough of them already. Instead of marking strings for translation within the source code, they are marked (for non-translation) in the message file. This must be done at some point, but it&rsquo;s better to do it in a dedicated place, not in the code.</p>
<p>This of course comes at a cost: unlike with gettext where the user can switch between languages, software translated with Trubar requires a separate distribution for each language. Or packing separate sources for multiple languages into one distribution. Whether this hurts or not, depends upon circumstances.</p>
<h2 id="what-about-plural-forms">What about plural forms?</h2>
<p>You ask that seriously? So you don&rsquo;t speak Slovenian, I guess.</p>
<p>See the text &ldquo;Ni ciljne spremenljivke&rdquo; in the screenshot? It means &ldquo;No target variable&rdquo;. Slovenian language counts like this:</p>
<pre tabindex="0"><code>Ni ciljne spremenljivke
Ena ciljna spremenljivka
Dve ciljni spremenljivki
Tri ciljne spremenljivke
Štiri ciljne spremenljivke
Pet ciljnih spremenljivk
...
</code></pre><p>and then the same form is used until 101, where we go back to singular, dual, plural, plural and genitive (which is what you see above).</p>
<p>Developed by native speaker of this beautifully complicated Slavic language, Trubar handles it with excellence. The beauty of f-strings is that they make implementation of plural forms much simpler because they allow using arbitrary functions. We simply inserted the appropriate function call and that&rsquo;s it. For instances, besides having four plural forms, the translation of proposition &ldquo;with&rdquo; before a number depends upon the number, and this is handled simply by using the function that returns the proper former for the given number. Which all happens without any help in the original source.</p>
<p>More about localization in <a href="http://janezd.github.io/trubar/localization/">documentation</a>.</p>
<h2 id="ready-to-use">Ready to use?</h2>
<p>Sure, try it out. Trubar is <a href="https://pypi.org/project/trubar/">pip-installable</a>, <a href="http://janezd.github.io/trubar/">documentation</a> is decent enough and although it is still early in development, we don&rsquo;t plan any huge changes. The least we can promise is that its compatibility-breaking changes will give you less headache that those by pyqtgraph. (Though &hellip; this may not be much of a promise. :)</p>

            </div>
            </article>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://orange-4.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#blog_images_').lightGallery({
        thumbnail: false,
        selector: 'a:has(img)',
        width: '60%',
        mode: 'lg-fade',
        counter: false,
        download: false,
        enableSwipe: false,
        enableDrag: false,
        speed: 1,
        useLeft: true,
        hideBarsDelay: 1000
    });
    });
</script>

        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <div class="row">

                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Orange</div></b></li>
                                <li><a class="sitemap-sub" href="/faq/">FAQ</a></li>
                                <li><a class="sitemap-sub" href="/license/">License</a></li>
                                <li><a class="sitemap-sub" href="/privacy/">Privacy</a></li>
                                <li><a class="sitemap-sub" href="/citation/">Citation</a></li>
                                <li><a class="sitemap-sub" href="/contact/">Contact</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Download</div></li>
                                <li><a class="sitemap-sub" href="/download/#windows">Windows</a></li>
                                <li><a class="sitemap-sub" href="/download/#macos">Mac OS</a></li>
                                
                            </ul>
                        </div>

                        <div class="col-sm-4 sitemap-group">

                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Community</div></b></li>
                                <li><a class="sitemap-sub" href="https://www.facebook.com/orangedatamining" target="_blank">Facebook</a></li>
                                <li><a class="sitemap-sub" href="https://www.youtube.com/channel/UClKKWBe2SCAEyv7ZNGhIe4g" target="_blank">YouTube</a></li>
                                <li><a class="sitemap-sub" href="https://twitter.com/orangedataminer" target="_blank">Twitter</a></li>
                                <li><a class="sitemap-sub" href="https://datascience.stackexchange.com/questions/tagged/orange" target="_blank">Stack Exchange</a></li>
                                <li><a class="sitemap-sub" href="https://discord.gg/FWrfeXV" target="_blank">Discord</a></li>
                            </ul>

                        </div>

                    </div>
                </div>

                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="row">

                        <div class="col-sm-5 col-md-7 col-lg-6 sitemap-group docs-devs">
                            <ul class="links list-sitemap">
                                <li><div class="sitemap-cat">Documentation</div></li>
                                <li><a class="sitemap-sub" href='/getting-started/'>Get started</a></li>
                                <li><a class="sitemap-sub" href="/widget-catalog/">Widgets</a></li>
                                <li><a class="sitemap-sub" href="http://docs.biolab.si/3/data-mining-library/">Scripting</a></li>
                            </ul>
                        </div>

                        <div class="col-sm-3 sitemap-group">
                            <ul class="links list-sitemap">
                                <li><b><div class="sitemap-cat">Developers</div></b></li>
                                <li><a class="sitemap-sub" target="_blank" href="https://github.com/biolab/orange3">GitHub</a></li>
                                <li><a class="sitemap-sub" target="_blank" href="http://docs.biolab.si/3/development/">Getting Started</a></li>
                            </ul>
                        </div>

                    </div>
                </div>

                <div class="col-md-5 col-sm-12 col-xs-12 sitemap-group">
                    <div class="latest-blog-posts">
                        <ul class="links list-sitemap" style="padding-bottom: 10px">
                            <li><b><a class="sitemap-cat" href="/blog/">Latest blog posts</a></b></li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 17 Jan </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2023/2023-01-17-trubar/">Meet Trubar, a friend of Orange</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 13 Dec </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2022/2022-12-13-dask-table/">Orange you going to ask about dask?</a>
                            </div>
                            </div>
                            </li>
                            
                            <li>
                            <div class="row">
                            <div class="col-md-2"><a class="sitemap-sub"> 25 Nov </a></div>
                            <div class="col-md-10">
                                <a class="sitemap-sub" style="color: #f79211" href="/blog/2022/2022-25-11-clustering-videos/">Videos on hierarchical clustering</a>
                            </div>
                            </div>
                            </li>
                            
                        </ul>
                    </div>
                </div>

            </div>

            <div class="row footer-pad">
                <div class="col-xs-12">
                    <small class="copyright pull-left"  >Copyright © University of Ljubljana</small>
                </div>
            </div>
        </div>
    </footer>

    </body>
</html>